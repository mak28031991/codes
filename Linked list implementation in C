#include<stdio.h>
#include<stdlib.h>
struct node 
{
    int data;
    struct node * next;    
};
struct node * GetNewNode(int num)
{
    struct node * newnode;
	
    newnode=(struct node *) malloc(sizeof(struct node ));
    if(!newnode)
    {
        printf("memory error\n");
        return;
    }
    newnode->data=num;
return newnode;
}
void Append(struct node ** head, int num)
{
    struct node * last;
	last = *head;
	struct node * newnode = GetNewNode(num);
    newnode->next=NULL;
   
    if(*head==NULL)
    {    
        *head = newnode;
		Display(*head);	
		printf("Length of Linked List is %d \n",Length(*head));
        return ;
    }
   
    while(last->next!=NULL)
    {
		last=(last)->next;
    }
        last->next= newnode;
		Display(*head);	
		printf("Length of Linked List is %d \n",Length(*head));
        return ;  
	
}
void AddAtBegin(struct node ** head, int num)
{
    struct node * newnode;
	newnode=GetNewNode(num);
	newnode->next=*head;
	*head=newnode;
	Display(*head);
	printf("Length of Linked List is %d \n",Length(*head));
	
}
void AddAfter( struct node * head,int index, int num)
{
	struct node * newnode=GetNewNode(num);
	struct node * headcopy =head;
	int i=1;
	while(i<index && head!=NULL)
	{
		i++;
		head=head->next;
	}
	if(i==index)
	{
		newnode->next=head->next;
		head->next=newnode;
	}
	else
	{
		printf("entered index in not available");
	}
	Display(headcopy);
	printf("Length of Linked List is %d \n",Length(headcopy));
}
void Display(struct node * head)
{
    while(head!=NULL)
    {
        printf("%d ",head->data);
        head=head->next;
    }
printf("\n");
}
void Delete(struct node ** head,int index)
{
    
	if(index==1)
	{
		*head = (*head)->next;
	}
	else
	{
		struct node * prev;
		prev= *head;
		int i=1;
		while(i<index-1 && prev!=NULL)
		{
			i++;
			prev=prev->next;
		}
		if(i==index-1)
		{
			prev->next=(prev->next)->next;
		}
		else
		{
			printf("entered index in not available");
		}
	}	
	Display(*head);
	printf("Length of Linked List is %d \n",Length(*head));
}
int Length(struct node * head)
{
	int count=1;
	while(head->next!=NULL)
	{
		count++;
		head= head->next;
	}
	return count;
}
void Search(struct node * head, int x)
{
	int count=1;
	if(head == NULL)
	{
		printf("Linked list is empty\n");
		return;
	}
	
	while(head!=NULL)
	{
		if(head->data==x)
		{
			printf("%d is found at node no: %d\n",x,count);
			return;
		}
		else
		{
			count++;
			head= head->next;
		}
	}
	printf("node with %x not found\n",x);
	return ;
}
void NthNode(struct node * head, int n)
{
	int count=1;
	if(n<=0 || n > Length(head))
	{
		printf(" Not a valid node.\n");
		return;
	}
	if(head==NULL)
	{
		printf("Linked List is empty\n");
		return;
	}
	while(head!=NULL && count!=n)
	{
		head=head->next;
		count++;
	}
	
		printf("Element at %d node is %d \n",n,head->data);
		return;
	
	
	
}

int main()
{
    struct node * ll=NULL;
	Search(ll,8);
    Append(&ll,3);
	
    Append(&ll,5);
	
	Append(&ll,7);
	
    Append(&ll,9);

	AddAtBegin(&ll,2);
	
	AddAtBegin(&ll,1);

	AddAtBegin(&ll,0);

	AddAfter(ll,4,4);
	
	AddAfter(ll,6,6);

	AddAfter(ll,8,8);

	Delete(&ll,1);

	Delete(&ll,3);
	Search(ll,5);
	Search(ll,3);
	Search(ll,7);
	Search(ll,17);
	NthNode(ll,5);
	NthNode(ll,2);
	
    return 0;
}
